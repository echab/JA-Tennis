<div ng-if="ctrlDraw.isKnockout" class="draw knockout" ng-style="{width: ctrlDraw.width +'px', height: ctrlDraw.height +'px'}"
     ng-click="main.select(null,main.ModelType.Box)">
    <canvas draw-lines="ctrlDraw._refresh"><v:shape filled="0" stroked="1" style="position:absolute; left:0px; top:0px;"/></canvas>
    <div ng-repeat="box in ctrlDraw.draw.boxes" ng-if="!ctrlDraw.simple">
        <div draw-box="box" class="box"
             ng-style="{left:(box._x * ctrlDraw.boxWidth) +'px', top:(box._y * ctrlDraw.boxHeight) +'px'}"></div>
    </div>
</div>
<table ng-if="!ctrlDraw.isKnockout" class="draw roundrobin"
       ng-click="main.select(null,main.ModelType.Box)">
    <tbody>
        <tr ng-style="{height: ctrlDraw.boxHeight +'px'}">
            <td ng-style="{width: ctrlDraw.boxWidth +'px'}"></td>
            <td ng-repeat="row in ctrlDraw.rows" ng-style="{width: ctrlDraw.boxWidth +'px'}">
                <div draw-box="ctrlDraw.getBox(row[0])" ng-if="!ctrlDraw.simple"></div>
            </td>
            <td>
                <div ng-repeat="i in ctrlDraw.range(1, ctrlDraw.draw.nbOut)" class="qualifOut">Q{{i}}</div>
            </td>
        </tr>
        <tr ng-repeat="row in ctrlDraw.rows" ng-style="{height: ctrlDraw.boxHeight +'px'}">
            <td ng-repeat="col in row" ng-class="{diag: ctrlDraw.isDiag(col)}">
                <div draw-box="ctrlDraw.getBox(col)" ng-if="!ctrlDraw.simple"></div>
            </td>
        </tr>
    </tbody>
</table>
<div class="action"
     ng-if="!ctrlDraw.simple && main.selection.box"
     ng-style="{left:(1+ main.selection.box._x * ctrlDraw.boxWidth) +'px', top:((main.selection.box._y +1) * ctrlDraw.boxHeight -2) +'px'}"
     ng-switch="ctrlDraw.draw.mode">
    <div class="btn-group" ng-switch-when="0">
        <button class="btn dropdown-toggle" ng-disabled="ctrlDraw.isMatch(main.selection.box)" title="Select the qualified">
            <i class="icon2-qualif-in"></i><span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li ng-repeat="q in ctrlDraw.getQualifsIn()">
                <a ng-click="ctrlDraw.setPlayer(main.selection.box, q._player, q.qualifOut)">
                    <i class="icon2-white" ng-class="{'icon2-checkmark':ctrlDraw.findQualifIn(q.qualifOut)}"></i><!-- -->
                    {{'Q' + q.qualifOut + ' ' + q._player.name}}
                </a>
            </li>
        </ul>
    </div><div class="btn-group" ng-switch-when="0">
        <button class="btn dropdown-toggle" ng-disabled="ctrlDraw.isMatch(main.selection.box)" title="Edit the player">
            <i class="icon2-player"></i><span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            <li><a ng-click="main.editPlayer(main.selection.box._player)"><i class="icon2-info"></i> Edit</a></li>
            <li class="divider"></li>
            <li ng-repeat="player in ctrlDraw.getPlayers()">
                <a ng-click="ctrlDraw.setPlayer(main.selection.box, player)">
                    <i class="icon2-white" ng-class="{'icon2-checkmark':ctrlDraw.findPlayer(player.id)}"></i>
                    {{player.name +' '+ player.rank}}
                </a>
            </li>
        </ul>
    </div><button class="btn" ng-switch-when="0" ng-disabled="!main.selection.box.playerId"
                  ng-click="ctrlDraw.swapPlayer(main.selection.box)" title="Swap the player">
        <i class="icon2-switch"></i>
    </button><button class="btn" ng-switch-when="0" ng-disabled="!main.selection.box.playerId && !main.selection.box.qualifIn"
                     ng-click="ctrlDraw.setPlayer(main.selection.box)" title="Remove the player">
        <i class="icon2-erase"></i>
    </button>

    <button class="btn" ng-switch-when="1" ng-disabled="!ctrlDraw.isMatch(main.selection.box)"
            ng-click="main.editMatch(main.selection.box)" title="Set the date and hour of the match">
        <i class="icon2-planning"></i>
    </button><button class="btn" ng-switch-when="1" ng-disabled="!ctrlDraw.isMatch(main.selection.box)"
                     ng-click="main.editMatch(main.selection.box)" title="Change the match place">
        <i class="icon-map-marker"></i>
    </button><button class="btn" ng-switch-when="1" ng-disabled="!main.selection.box.place && !main.selection.box.date"
                     ng-click="main.editMatch(main.selection.box)" title="Remove the place and date of the match">
        <i class="icon2-erase"></i>
    </button>

    <button class="btn" ng-switch-when="2" ng-disabled="!ctrlDraw.isMatch(main.selection.box)"
            ng-click="main.editMatch(main.selection.box)" title="Edit the match">
        <i class="icon2-match"></i>
    </button><button class="btn" ng-switch-when="2" ng-disabled="!main.selection.box.playerId"
                     ng-click="main.editMatch(main.selection.box)" title="Remove the result">
        <i class="icon2-erase"></i>
    </button>
</div>
